# AI Execution Envelope

> **A governance framework for autonomous agents that execute real-world side effects.**

[![Status](https://img.shields.io/badge/status-proposal%20v0.1-orange)]()
[![License](https://img.shields.io/badge/License-CC%20BY--SA%204.0-blue.svg)]()

**Language / 语言：** English | [中文](README.zh.md)

---

## The Problem

When an LLM is a coding assistant, traditional software engineering is sufficient.

When an LLM becomes an autonomous execution agent — modifying databases, placing trades, triggering deployments, calling external APIs without per-action human review — the governance model breaks.

**Code-Centric governance assumes a human is responsible for every action.**
That assumption is no longer valid.

The failure mode is structural, not incidental:

- Risk controls are embedded in strategy code, not enforced independently
- There is no enforceable pre-execution authorization boundary
- Violations are detectable only after the fact, when side effects are already real

---

## The Proposal

**Execution Envelope–Centric governance.**

> An **Execution Envelope** is a formally defined and enforceable boundary of permissible actions within which an autonomous agent must operate.

Every autonomous task must be governed by an Execution Envelope **before** any code runs.

The Envelope defines:

| Field | Purpose |
|---|---|
| `goal` | Declared task intent |
| `capabilities` | What resources the agent may access |
| `budgets` | Hard consumption limits |
| `forbidden` | Explicitly prohibited actions |
| `postconditions` | Verifiable completion criteria |

The Envelope is not documentation. It is the **control plane** — verified before execution, enforced at runtime by a proxy that operates outside the agent's control domain.

---

## Core Principles

**1. The Envelope precedes the code.**
No agent action is permitted without a valid, verified Envelope. Code is an implementation detail; the Envelope is the authority.

**2. Enforcement is not optional.**
If an agent can bypass the enforcement layer through any path, the architecture has failed. Enforcement must be a physical and network-layer fact, not a convention.

**3. The control plane is independent.**
The Envelope definition and the enforcement logic must run outside the agent's control domain. An agent that can modify its own governance layer has no governance layer.

**4. Envelopes are ephemeral capability instances.**
An Envelope is not a long-term permission grant. It is a scoped, time-bounded authorization for a single task execution.

**5. Compliance ≠ Correctness.**
The Envelope guarantees behavioral legality, not semantic correctness. Quality assurance requires independent mechanisms.

---

## What This Is Not

| Not this | Why |
|---|---|
| A replacement for IAM | IAM manages long-term identity permissions (static). Envelopes manage per-task authorization (dynamic). |
| A replacement for OPA/Cedar | Policy engines evaluate rules. Envelopes provide the structured task instance for them to evaluate. |
| A replacement for Temporal | Temporal ensures execution consistency. Envelopes determine whether execution is permitted. |
| A new programming language | General-purpose languages remain in the data plane. The Envelope is the control plane. |
| A correctness guarantee | Envelopes bound behavior. They do not guarantee that bounded behavior produces correct results. |

---

## Repository Structure

```
ai-execution-envelope/
│
├── README.md                        # This file (English)
├── README.zh.md                     # 中文版
│
├── spec/
│   └── PRINCIPLES.md                # Formal statement of framework principles
│
├── schema/
│   └── envelope.schema.json         # JSON Schema v0.1 for Execution Envelopes
│
├── examples/
│   └── trading/
│       ├── envelope.json            # Example: intraday MNQ strategy
│       └── template.json            # Example: org-level envelope template
│
├── gateway/
│   └── VERIFICATION_SPEC.md         # Gateway enforcement specification
│
└── docs/
    └── THREAT_MODEL.md              # Threat model and non-goals
```

---

## Threat Model (Summary)

We address:

- Agent actions that exceed authorization boundaries
- Unbounded resource consumption
- Irreversible side effects triggered without pre-verification
- Actions that cannot be audited or replayed

We do **not** address:

- LLM hallucination or semantic errors
- Algorithm correctness
- Data accuracy
- Market or financial risk
- Strategic decision quality

Full threat model: [`docs/THREAT_MODEL.md`](docs/THREAT_MODEL.md)

---

## The Three-Layer Generation Model

An Execution Envelope is not freely generated by the LLM. This would make governance vacuous.

```
Layer 1: Organization defines envelope templates
         (humans + security team, versioned, reviewed)
              ↓
Layer 2: LLM instantiates parameters within template bounds
         (fills task-specific fields; cannot create new capability types)
              ↓
Layer 3: Verifier checks the envelope before execution
         (automated + human approval where required)
              ↓
         Execution permitted (or rejected)
```

The LLM is a **parameter instantiator**, not a rule author.

---

## Enforcement Architecture

```
┌─────────────────────┐
│   Agent / Strategy  │  ← No API keys. No external network access.
│   (data plane)      │    Can only submit requests to Gateway.
└──────────┬──────────┘
           │ internal request only
           ▼
┌─────────────────────┐
│   Order Gateway /   │  ← Holds credentials. Enforces Envelope.
│   Runtime Proxy     │    Runs outside agent control domain.
│   (control plane)   │    Logs every action.
└──────────┬──────────┘
           │ verified, authorized calls only
           ▼
┌─────────────────────┐
│   External Systems  │
│   (exchange / API)  │
└─────────────────────┘
```

**If the agent can reach external systems through any path other than the Gateway, the architecture has failed.**

Full enforcement specification: [`gateway/VERIFICATION_SPEC.md`](gateway/VERIFICATION_SPEC.md)

---

## Status

This is a **framework proposal**, not a production implementation.

- [x] Threat model
- [x] Core principles
- [x] JSON Schema v0.1
- [x] Trading example
- [x] Gateway verification spec
- [ ] Reference implementation (Gateway proxy)
- [ ] Formal capability lattice definition
- [ ] Cross-organization envelope exchange protocol

---

## Contributing

This project is in early proposal stage. Contributions most needed:

- Critique of the threat model
- Alternative enforcement architectures
- Domain-specific envelope examples (deployment, DB migration, payment)
- Formal treatment of capability semantics

---

## License

CC BY-SA 4.0
